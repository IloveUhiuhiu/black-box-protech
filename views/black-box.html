<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Box Game</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/forms.css">
    <style>
        .container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
        }
        .function-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .input-group {
            margin-bottom: 1.5rem;
        }
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #333;
        }
        .string-input {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-family: monospace;
        }
        .string-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
        }
        .execute-button {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .execute-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40,167,69,0.3);
        }
        .result-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            margin: 2rem 0;
            display: none;
        }
        .result-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 1rem 0;
            font-family: monospace;
            word-break: break-all;
        }
        .function-info {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #007bff;
        }
        .nav-buttons {
            text-align: center;
            margin: 2rem 0;
        }
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            margin: 0.5rem;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background: #545b62;
        }
        .header-logo {
            text-align: center;
            margin-bottom: 2rem;
        }
        .header-logo img {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        .header-logo img:hover {
            transform: scale(1.05);
        }
        .header-logo p {
            margin-top: 0.5rem;
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-logo">
            <img src="/images/logo.jpg" alt="ProTech Club Logo">
            <p>ProTech Club</p>
        </div>
        
        <div class="function-info">
            <h2 id="functionTitle">üîß Black Box</h2>
            <p id="functionDescription">ƒêang t·∫£i th√¥ng tin function...</p>
        </div>
        
        <div class="function-container">
            <div class="input-group">
                <label for="stringInput">Nh·∫≠p input:</label>
                <input 
                    type="text" 
                    id="stringInput" 
                    class="string-input" 
                    placeholder="Nh·∫≠p input ƒë·ªÉ x·ª≠ l√Ω..."
                    oninput="updatePreview()"
                >
            </div>
            
            <button onclick="executeFunction()" class="execute-button" id="executeBtn">
                ‚ö° Th·ª±c thi function
            </button>
        </div>
        
        <div id="resultDisplay" class="result-display">
            <h3 style="margin-top: 0;">‚ú® K·∫øt qu·∫£</h3>
            <div class="result-value" id="resultValue">
                <!-- K·∫øt qu·∫£ s·∫Ω hi·ªán ·ªü ƒë√¢y -->
            </div>
            
        </div>
        
        <div class="nav-buttons">
            <a href="/home" class="btn btn-secondary">üéÆ V·ªÅ game</a>
        </div>
    </div>

    <script>
        // L·∫•y m√£ function t·ª´ URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const functionCode = urlParams.get('code');
        let functionInfo = {};
        
        
        // =================================================================
        //   C√°c h√†m x·ª≠ l√Ω String + Number (theo y√™u c·∫ßu)
        // =================================================================

        const getStringLength = (str) => str.length;
        const countSpaces = (str) => (str.match(/ /g) || []).length;
        const startsWithA = (str) => str.toLowerCase().startsWith('a');
        const checkLengthGreaterThan5 = (str) => str.length > 5 ? 'D√†i' : 'Ng·∫Øn';
        const multiplyByTwo = (num) => num * 2;
        const isEven = (num) => num % 2 === 0;
        const modulo5 = (num) => num % 5;
        const isPositive = (num) => num > 0;
        const divideByTwo = (num) => num / 2;
        const doubleChars = (str) => str.split('').map(c => c + c).join('');
        const factorial = (num) => {
            if (num < 0) return NaN;
            if (num === 0) return 1;
            return num * factorial(num - 1);
        };
        const isPrime = (num) => {
            if (num <= 1) return false;
            for (let i = 2; i <= Math.sqrt(num); i++) {
                if (num % i === 0) return false;
            }
            return true;
        };
        const isGreaterThan100 = (num) => num > 100;
        const reverseString = (str) => str.split('').reverse().join('');
        const countVowels = (str) => (str.toLowerCase().match(/[aeiou]/g) || []).length;
        const isPalindrome = (str) => {
            const cleaned = str.toLowerCase().replace(/[^a-z0-9]/g, '');
            return cleaned === cleaned.split('').reverse().join('');
        };
        const countWords = (str) => str.trim().split(/\s+/).length;
        const extractDigits = (str) => str.match(/\d/g)?.join('') || '';
        const findFirstA = (str) => str.toLowerCase().indexOf('a');
        const countUpperCaseChars = (str) => (str.match(/[A-Z]/g) || []).length;
        const sumDigits = (num) => String(num).split('').reduce((sum, d) => sum + Number(d), 0);
        const fizzBuzz = (num) => {
            if (num % 15 === 0) return 'FizzBuzz';
            if (num % 3 === 0) return 'Fizz';
            if (num % 5 === 0) return 'Buzz';
            return num;
        };

        // =================================================================
        //   Metadata cho t·ª´ng h√†m v·ªõi m√£ random 8 k√Ω t·ª±
        // =================================================================
        const functionDetails = {
            st01ln34: {
                name: 'Get String Length',
                description: 'Tr·∫£ v·ªÅ ƒë·ªô d√†i c·ªßa chu·ªói',
                icon: 'üìè',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: getStringLength
            },
            ab12dg23: {
                name: 'Count Spaces',
                description: 'ƒê·∫øm s·ªë l∆∞·ª£ng kho·∫£ng tr·∫Øng trong chu·ªói',
                icon: '‚ê£',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: countSpaces
            },
            xy9k4lm2: {
                name: 'Starts With A',
                description: 'Ki·ªÉm tra chu·ªói c√≥ b·∫Øt ƒë·∫ßu b·∫±ng ch·ªØ "a"',
                icon: 'üÖ∞Ô∏è',
                input: 'Chu·ªói',
                output: 'Boolean',
                active: true,
                func: startsWithA
            },
            qr78op56: {
                name: 'Is Greater Than 100',
                description: 'Ki·ªÉm tra s·ªë c√≥ l·ªõn h∆°n 100 kh√¥ng',
                icon: 'üìà',
                input: 'S·ªë',
                output: 'Boolean',
                active: true,
                func: isGreaterThan100
            },
            mn34st90: {
                name: 'Reverse String',
                description: 'ƒê·∫£o ng∆∞·ª£c chu·ªói k√Ω t·ª±',
                icon: 'üîÑ',
                input: 'Chu·ªói',
                output: 'Chu·ªói',
                active: true,
                func: reverseString
            },
            kl56uv12: {
                name: 'Count Vowels',
                description: 'ƒê·∫øm s·ªë l∆∞·ª£ng nguy√™n √¢m (a, e, i, o, u)',
                icon: 'üîé',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: countVowels
            },
            zx90qw34: {
                name: 'Is Palindrome',
                description: 'Ki·ªÉm tra chu·ªói c√≥ ph·∫£i Palindrome',
                icon: 'üîÅ',
                input: 'Chu·ªói',
                output: 'Boolean',
                active: true,
                func: isPalindrome
            },
            rt12gh78: {
                name: 'Count Words',
                description: 'ƒê·∫øm s·ªë l∆∞·ª£ng t·ª´ trong chu·ªói',
                icon: 'üìñ',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: countWords
            },
            cv34bn56: {
                name: 'Extract Digits',
                description: 'L·∫•y t·∫•t c·∫£ c√°c ch·ªØ s·ªë trong chu·ªói',
                icon: 'üî¢',
                input: 'Chu·ªói',
                output: 'Chu·ªói',
                active: true,
                func: extractDigits
            },
            pl78ok90: {
                name: 'Find First A',
                description: 'Tr·∫£ v·ªÅ v·ªã tr√≠ c·ªßa ch·ªØ "a" ƒë·∫ßu ti√™n',
                icon: 'üìç',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: findFirstA
            },
            hj23df67: {
                name: 'Count Uppercase Characters',
                description: 'ƒê·∫øm s·ªë k√Ω t·ª± in hoa trong chu·ªói',
                icon: 'üî†',
                input: 'Chu·ªói',
                output: 'S·ªë nguy√™n',
                active: true,
                func: countUpperCaseChars
            },
            we45ty89: {
                name: 'Sum Digits',
                description: 'T√≠nh t·ªïng c√°c ch·ªØ s·ªë c·ªßa m·ªôt s·ªë',
                icon: '‚ûï',
                input: 'S·ªë',
                output: 'S·ªë',
                active: true,
                func: sumDigits
            },
            ui67za01: {
                name: 'FizzBuzz',
                description: 'Tr·∫£ v·ªÅ Fizz/Buzz/FizzBuzz theo quy t·∫Øc 3-5-15',
                icon: 'üé≤',
                input: 'S·ªë',
                output: 'Chu·ªói ho·∫∑c S·ªë',
                active: true,
                func: fizzBuzz
            },
            lg15gt05: {
                name: 'Check Length Greater Than 5',
                description: 'Tr·∫£ v·ªÅ "D√†i" n·∫øu ƒë·ªô d√†i > 5, "Ng·∫Øn" n·∫øu ng∆∞·ª£c l·∫°i',
                icon: 'üìê',
                input: 'Chu·ªói',
                output: 'Chu·ªói',
                active: true,
                func: checkLengthGreaterThan5
            },
            mb16x002: {
                name: 'Multiply By Two',
                description: 'Nh√¢n s·ªë ƒë√≥ v·ªõi 2',
                icon: '‚úñÔ∏è',
                input: 'S·ªë',
                output: 'S·ªë',
                active: true,
                func: multiplyByTwo
            },
            ev18ch02: {
                name: 'Is Even',
                description: 'Ki·ªÉm tra xem s·ªë ƒë√≥ c√≥ ph·∫£i l√† s·ªë ch·∫µn kh√¥ng',
                icon: '‚öñÔ∏è',
                input: 'S·ªë',
                output: 'Boolean',
                active: true,
                func: isEven
            },
            md23m005: {
                name: 'Modulo 5',
                description: 'L·∫•y ph·∫ßn d∆∞ khi chia cho 5',
                icon: '‚ûó',
                input: 'S·ªë',
                output: 'S·ªë',
                active: true,
                func: modulo5
            },
            ps24tr01: {
                name: 'Is Positive',
                description: 'Tr·∫£ v·ªÅ true n·∫øu s·ªë d∆∞∆°ng, false n·∫øu s·ªë √¢m (0 ƒë∆∞·ª£c coi l√† kh√¥ng d∆∞∆°ng kh√¥ng √¢m)',
                icon: '‚ûï',
                input: 'S·ªë',
                output: 'Boolean',
                active: true,
                func: isPositive
            },
            dv25by02: {
                name: 'Divide By Two',
                description: 'Chia s·ªë ƒë√≥ cho 2',
                icon: '‚ûó',
                input: 'S·ªë',
                output: 'S·ªë',
                active: true,
                func: divideByTwo
            },
            dc41x002: {
                name: 'Double Characters',
                description: 'L·∫∑p l·∫°i m·ªói k√Ω t·ª± 2 l·∫ßn',
                icon: 'üî§',
                input: 'Chu·ªói',
                output: 'Chu·ªói',
                active: true,
                func: doubleChars
            },
            ft47cal1: {
                name: 'Factorial',
                description: 'T√≠nh giai th·ª´a c·ªßa m·ªôt s·ªë',
                icon: 'üìà',
                input: 'S·ªë',
                output: 'S·ªë',
                active: true,
                func: factorial
            },
            pr48chk1: {
                name: 'Is Prime',
                description: 'Ki·ªÉm tra xem s·ªë c√≥ ph·∫£i l√† s·ªë nguy√™n t·ªë kh√¥ng',
                icon: 'üíé',
                input: 'S·ªë',
                output: 'Boolean',
                active: true,
                func: isPrime
            }
        };

        // =================================================================
        //   Danh s√°ch m√£ function h·ª£p l·ªá (hardcode)
        // =================================================================
        const validCodes = [
            'st01ln34',
            'ab12dg23',
            'xy9k4lm2',
            'qr78op56',
            'mn34st90',
            'kl56uv12',
            'zx90qw34',
            'rt12gh78',
            'cv34bn56',
            'pl78ok90',
            'hj23df67',
            'we45ty89',
            'ui67za01',
            'lg15gt05',
            'mb16x002',
            'ev18ch02',
            'md23m005',
            'ps24tr01',
            'dv25by02',
            'dc41x002',
            'ft47cal1',
            'pr48chk1'
        ];

        
        // Ki·ªÉm tra m√£ function c√≥ h·ª£p l·ªá v√† active kh√¥ng
        function isValidAndActive(code) {
            return validCodes.includes(code) && functionDetails[code]?.active;
        }
        
        // Load th√¥ng tin function
        function loadFunctionInfo() {
            if (isValidAndActive(functionCode)) {
                functionInfo = functionDetails[functionCode];
            }
            initFunction();
        }
        
        // Kh·ªüi t·∫°o function
        function initFunction() {
            if (functionInfo) {
                document.getElementById('functionTitle').innerHTML = `üîß M√£ v√≤ng ch∆°i: ${functionCode}`;
                document.getElementById('functionDescription').innerHTML = `
                    <strong>Input:</strong> ${functionInfo.input}<br>
                    <strong>Output:</strong> ${functionInfo.output}
                `;
                document.getElementById('executeBtn').innerHTML = `‚ö° Th·ª±c thi`;
                document.title = `${functionCode} - Black Box`;
            } else {
                document.getElementById('functionTitle').innerHTML = '‚ùå Function kh√¥ng t·ªìn t·∫°i';
                document.getElementById('functionDescription').textContent = 'M√£ function kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng ho·∫°t ƒë·ªông.';
            }
        }
        
        function updatePreview() {
            const input = document.getElementById('stringInput').value;
            const executeBtn = document.getElementById('executeBtn');
            
            if (input.length > 0) {
                executeBtn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
            } else {
                executeBtn.style.background = '#6c757d';
            }
        }
        
        function executeFunction() {
            const input = document.getElementById('stringInput').value;
            
            if (!input) {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p chu·ªói!');
                document.getElementById('stringInput').focus();
                return;
            }
            
            if (!functionInfo) {
                alert('‚ùå Function kh√¥ng t·ªìn t·∫°i!');
                return;
            }
            
            try {
                // Th·ª±c thi function tr·ª±c ti·∫øp
                const result = functionInfo.func(input);
                
                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                document.getElementById('resultValue').textContent = result;
                document.getElementById('resultDisplay').style.display = 'block';
                
                // Scroll xu·ªëng k·∫øt qu·∫£
                document.getElementById('resultDisplay').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                alert('‚ùå L·ªói khi th·ª±c thi function: ' + error.message);
            }
        }
        
        // X·ª≠ l√Ω ph√≠m Enter
        document.getElementById('stringInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                executeFunction();
            }
        });
        
        // Kh·ªüi t·∫°y khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            loadFunctionInfo(); // Load function info
            document.getElementById('stringInput').focus();
        });
    </script>
</body>
</html>
